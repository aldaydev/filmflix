@let film = filmDetails();

@if(film){

<div class="filmPage__marginContainer">

    <!-- FILM DATA SECTION -->
    <section class="filmPage__filmData">

        <header class="filmData__header">
            <hgroup class="filmData__titles">
                <h1 class="filmData__title">{{film.title}}</h1>
                @if(film.tagline){
                    <h2 class="filmData__subtitle">{{film.tagline}}</h2>
                }
            </hgroup>
            
            <button class="filmData__returnButton" (click)="goBack()">
                <svg xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" [class.dark]="themeService.theme() === 'dark'" fill="#ffffff"><path d="m320.62-93.85-56.77-56.77L593.23-480 263.85-809.38l56.77-56.77L706.77-480 320.62-93.85Z"/></svg>
                
            </button>
        </header>

        <article class="filmData__infoContainer">
            <div class="filmData__rateContainer">
                <app-five-stars-rate [vote_average]="film.vote_average | roundRate" />
                <h3 class="filmData__rateText">{{film.vote_average | roundRate}}</h3>
            </div>

            <div class="filmData__timesContainer">
                <h4 class="filmData__duration">Duración: {{film.runtime}} min</h4>
                <p class="filmData__release">Estreno: {{film.release_date.slice(0, 7)}}</p>
            </div>

            
            <p class="filmData__overview">{{!film.overview ? 'Actualmente no existe una sinópsis para esta película.' : film.overview}}</p>

            <ul class="filmData__genresContainer">
                @for (genre of film.genres; track $index) {
                <li class="filmData__genre">{{genre.name}}</li>
                }
            </ul>

        </article>

        @if(film.videos.results.length > 0){
        <article class="filmData__linksContainer">
            <app-button 
                size="big" label="VER VÍDEOS" 
                (handleClick)="openVideosModal()"
                [icon]="{src: 'assets/icons/watch_icon_white.svg', alt: 'videos'}" 
                [tabindex]="videosModalOpened() ? -1 : 0"
                id="film-page_watch-videos-button"
            />
        </article>
        }

        @if (videosModalOpened() && film.videos.results.length > 0) {
        <app-film-videos-modal 
            [isOpen]="videosModalOpened()"
            (closeModal)="closeVideosModal()"
            [videoData]="film.videos.results[0]"
        />
    }

    </section>

</div>
<!-- SIMILAR FILMS SECTION -->
<section class="filmPage__similarFilms">
    <h2 class="similarFilms__title">
        Películas similares
    </h2>       
    @if(film.similar.results.length > 0){
        <app-film-carousel
            [filmList]="similarFilms()"
            [tabindex]="videosModalOpened() ? false : true"
        />
    }@else {
        <span class="similarFilms__none">No tenemos películas similares que recomendarte</span>
    }
    
</section>

<!-- MORE ACTIONS SECTION -->
<section class="filmPage__moreActions">
    <h2 class="moreActions__title">
        ¿Buscas algo concreto?
    </h2>

    <article class="moreActions__searchForm">
        <app-input
            [placeholder]="'¿Qué película quieres buscar?'"
            size="small"
            [value]="searchState.selectedName()"
            (inputEvent)="searchState.setSelectedName($event)"
            (keydown.enter)="searchByNameFromFilm()"
            [tabindex]="videosModalOpened() ? -1 : 0"
            id="film-page_search-input"
        />
        <app-button
            label="Buscar"
            [icon]="{ src: 'assets/icons/search_icon_white.svg', alt: 'search' }"
            (click)="searchByNameFromFilm()"
            [tabindex]="videosModalOpened() ? -1 : 0"
            id="film-page_search-button"
        />
    </article>

   
    
</section>
}
